<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Color</title>
    <link href="https://fonts.googleapis.com/css?family=VT323" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="reset.css">
    <style type="text/css">

      body, * {
        font-size: 14px;
        font-family: 'Roboto Mono', monospace;
      }

      #color-form {
        width: 100%;
        margin: 2em 2em;
      }

      #color-form input {
        font-size: 24px;
      }

      #tints-shades {
        width: 100%;
      }

      #sats {
        width: 100%;
      }

      .color-block {
        display: inline-block;
        font-size: 2em;
        width: 5em;
        height: 5em;
        line-height: 5em;
        text-align: center;
        color: #fff;
        text-shadow: 0px 1px 3px #777;
      }

      label-shadow {
        text-shadow: 0px 1px 8px #000;
      }
    </style>
    <script src="d3.v4.min.js"></script>
  </head>
  <body>
    <div id="color-form">
      <input type="text" name="base-color" value="#">
      <div id="tints-shades"><h3>Tints and Shades</h3></div>
      <div id="sats"><h3>Saturation Spectrum</h3></div>
      <div id="neutrals">
        <h3>Neutrals</h3>
        <input type="text" name="neutral-amt" size="5" value="0.2" placeholder="0.0-1.0">
      </div>
    </div>
    <script src="tinter.js"></script>
    <script>
      let tinter = new Tinter()
      let colorInput = document.querySelector('input[name=base-color]')
      let neutralAmtInput = document.querySelector('input[name=neutral-amt]')
      let w = 400
      let h = 400

      let processColor = (baseColor) => {
        let triad = tinter.triadColors(baseColor)
        let splc = tinter.splitComplementaries(baseColor)
        console.log('baseColor: ', baseColor)
        d3.selectAll('div.color-block').remove()

        d3.selectAll('svg').remove()

        // 180 complementary
        let svg3 = d3.select('body')
                     .append('svg')
                     .attr('width', w)
                     .attr('height', h)
        svg3.selectAll('circle')
           .data([tinter.complementary(baseColor), baseColor])
           .enter()
           .append('circle')
           .attr('cx', (d, i) => {
             return 180 + 80 * Math.cos(i * Math.PI/1.5 + Math.PI/6)
           })
           .attr('cy', (d, i) => {
             return 120 + 80 * Math.sin(i * Math.PI/1.5 + Math.PI/6)
           })
           .attr('r', 60)
           .style('fill', (d) => {
             return d
           })
        svg3.selectAll('text')
           .data([tinter.complementary(baseColor), baseColor])
           .enter()
           .append('text')
           .attr('x', (d, i) => {
             return 180 + 80 * Math.cos(i * Math.PI/1.5 + Math.PI/6)
           })
           .attr('y', (d, i) => {
             return 120 + 80 * Math.sin(i * Math.PI/1.5 + Math.PI/6)
           })
           .attr('fill', 'white')
           .attr('text-anchor', 'middle')
           .attr('class', 'label-shadow')
           .text((d) => {
             return d
           })
        svg3.append('text')
            .attr('x', (w / 2))             
            .attr('y', 20)
            .attr('text-anchor', 'middle')  
            .style('font-size', '16px') 
            .text('180 Complementary')

        // Triad
        let svg = d3.select('body')
                    .append('svg')
                    .attr('width', w)
                    .attr('height', h)
        svg.selectAll('circle')
           .data(triad.concat(baseColor))
           .enter()
           .append('circle')
           .attr('cx', (d, i) => {
             return 180 + 80 * Math.cos(i * Math.PI/1.5 + Math.PI/6)
           })
           .attr('cy', (d, i) => {
             return 180 + 80 * Math.sin(i * Math.PI/1.5 + Math.PI/6)
           })
           .attr('r', 60)
           .style('fill', (d) => {
             return d
           })
        svg.selectAll('text')
           .data(triad.concat(baseColor))
           .enter()
           .append('text')
           .attr('x', (d, i) => {
             return 180 + 80 * Math.cos(i * Math.PI/1.5 + Math.PI/6)
           })
           .attr('y', (d, i) => {
             return 180 + 80 * Math.sin(i * Math.PI/1.5 + Math.PI/6)
           })
           .attr('fill', 'white')
           .attr('text-anchor', 'middle')
           .attr('class', 'label-shadow')
           .text((d) => {
             return d
           })
        svg.append('text')
           .attr('x', (w / 2))             
           .attr('y', 20)
           .attr('text-anchor', 'middle')  
           .style('font-size', '16px') 
           .text('Complementary Triad')

        // Split complementary
        let svg2 = d3.select('body')
                     .append('svg')
                     .attr('width', w)
                     .attr('height', h)
        svg2.selectAll('circle')
           .data(splc.concat(baseColor))
           .enter()
           .append('circle')
           .attr('cx', (d, i) => {
             return 180 + 80 * Math.cos(i * Math.PI/1.5 + Math.PI/6)
           })
           .attr('cy', (d, i) => {
             return 180 + 80 * Math.sin(i * Math.PI/1.5 + Math.PI/6)
           })
           .attr('r', 60)
           .style('fill', (d) => {
             return d
           })
        svg2.selectAll('text')
           .data(splc.concat(baseColor))
           .enter()
           .append('text')
           .attr('x', (d, i) => {
             return 180 + 80 * Math.cos(i * Math.PI/1.5 + Math.PI/6)
           })
           .attr('y', (d, i) => {
             return 180 + 80 * Math.sin(i * Math.PI/1.5 + Math.PI/6)
           })
           .attr('fill', 'white')
           .attr('text-anchor', 'middle')
           .attr('class', 'label-shadow')
           .text((d) => {
             return d
           })
        svg2.append('text')
            .attr('x', (w / 2))             
            .attr('y', 20)
            .attr('text-anchor', 'middle')  
            .style('font-size', '16px') 
            .text('Split Complementary Triad')

        d3.select('div#tints-shades')
          .append('div')
          .attr('class', 'color-block')
          .text(tinter.tintShade(baseColor, -0.6))
          .style('background-color', tinter.tintShade(baseColor, -0.6))
        d3.select('div#tints-shades')
          .append('div')
          .attr('class', 'color-block')
          .text(tinter.tintShade(baseColor, -0.4))
          .style('background-color', tinter.tintShade(baseColor, -0.4))
        d3.select('div#tints-shades')
          .append('div')
          .attr('class', 'color-block')
          .text(tinter.tintShade(baseColor, -0.2))
          .style('background-color', tinter.tintShade(baseColor, -0.2))
        d3.select('div#tints-shades')
          .append('div')
          .attr('class', 'color-block')
          .text(baseColor)
          .style('background-color', baseColor)
        d3.select('div#tints-shades')
          .append('div')
          .attr('class', 'color-block')
         .text(tinter.tintShade(baseColor, 0.2))
          .style('background-color', tinter.tintShade(baseColor, 0.2))
        d3.select('div#tints-shades')
          .append('div')
          .attr('class', 'color-block')
          .text(tinter.tintShade(baseColor, 0.4))
          .style('background-color', tinter.tintShade(baseColor, 0.4))
        d3.select('div#tints-shades')
          .append('div')
          .attr('class', 'color-block')
          .text(tinter.tintShade(baseColor, 0.6))
          .style('background-color', tinter.tintShade(baseColor, 0.6))

        d3.select('div#sats')
          .append('div')
          .attr('class', 'color-block')
          .text(tinter.modSaturation(baseColor, -0.6))
          .style('background-color', tinter.modSaturation(baseColor, -0.6))
        d3.select('div#sats')
          .append('div')
          .attr('class', 'color-block')
          .text(tinter.modSaturation(baseColor, -0.4))
          .style('background-color', tinter.modSaturation(baseColor, -0.4))
        d3.select('div#sats')
          .append('div')
          .attr('class', 'color-block')
          .text(tinter.modSaturation(baseColor, -0.2))
          .style('background-color', tinter.modSaturation(baseColor, -0.2))
        d3.select('div#sats')
          .append('div')
          .attr('class', 'color-block')
          .text(baseColor)
          .style('background-color', baseColor)
        d3.select('div#sats')
          .append('div')
          .attr('class', 'color-block')
         .text(tinter.modSaturation(baseColor, 0.2))
          .style('background-color', tinter.modSaturation(baseColor, 0.2))
        d3.select('div#sats')
          .append('div')
          .attr('class', 'color-block')
          .text(tinter.modSaturation(baseColor, 0.4))
          .style('background-color', tinter.modSaturation(baseColor, 0.4))
        d3.select('div#sats')
          .append('div')
          .attr('class', 'color-block')
          .text(tinter.modSaturation(baseColor, 0.6))
          .style('background-color', tinter.modSaturation(baseColor, 0.6))

        let neutralAmt = neutralAmtInput.value
        let baseGreys = [
          '#000000',
          '#333333',
          '#666666',
          '#999999',
          '#cccccc',
          '#ffffff'
        ]

        let greys = baseGreys.map((v, i) => {
          return tinter.addColorsRGB(v, baseColor, neutralAmt)
        })

        d3.select('div#neutrals')
          .selectAll('div')
          .data(greys)
          .enter()
          .append('div')
          .attr('class', 'color-block')
          .style('background-color', (d) => {
            return d
          })
          .text((d) => {
            return d
          })

        neutralAmtInput.addEventListener('keyup', (event) => {
          if (event.key === 'Enter') {
            neutralAmt = neutralAmtInput.value
            greys = baseGreys.map((v, i) => {
              return tinter.addColorsRGB(v, baseColor, neutralAmt)
            })

            d3.select('div#neutrals')
              .selectAll('div')
              .data(greys)
              .style('background-color', (d) => {
                return d
              })
              .text((d) => {
                return d
              })
          }
        })

        d3.select('body')
          .append('div')
          .attr('class', 'color-block')
          .text(tinter.zeroHue(baseColor))
          .style('background-color', tinter.zeroHue(baseColor))
      }

      if (document.location.hash) {
        colorInput.value = document.location.hash
        processColor(colorInput.value)
      }

      colorInput.addEventListener('keyup', (event) => {
        setTimeout(() => {
          if (colorInput.value.indexOf('#') !== 0) {
            colorInput.value = '#'
          }
        }, 1)

        if (event.key === 'Enter') {
          document.location.hash = colorInput.value
          processColor(colorInput.value)
        }
      })

    </script>
  </body>
</html>
